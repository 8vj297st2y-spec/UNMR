<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã†ã‚“ã‚‚ã‚‰ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰ - Unmora Project</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --main-brown: #8b5a2b;
      --main-blue: #5fd3ff;
      --bg-cream: #fff7e9;
      --akane-red: #ff4b5c;
      --card-radius: 18px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #e0f8ff 0, #fff7e9 40%, #f3e0c5 100%);
      color: #4a2b16;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .app {
      max-width: 480px;
      margin: 0 auto;
      padding: 12px 12px 64px;
      position: relative;
      min-height: 100vh;
    }

    header {
      text-align: center;
      padding: 8px 8px 4px;
      position: relative;
    }

    header h1 {
      margin: 4px 0;
      font-size: 1.6rem;
      color: var(--main-brown);
      text-shadow: 0 2px 0 rgba(255,255,255,0.8);
    }

    header .subtitle {
      font-size: 0.85rem;
      color: #6b4a2a;
    }

    .akane-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: linear-gradient(135deg, #ffe5e8, #ffc2ca);
      border-radius: 999px;
      padding: 4px 10px;
      margin-top: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.12);
      font-size: 0.8rem;
    }

    .akane-icon {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      background: var(--akane-red);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 0.9rem;
      box-shadow: 0 0 0 2px #fff, 0 2px 4px rgba(0,0,0,0.2);
    }

    .tab-nav {
      display: flex;
      margin: 10px 0 6px;
      border-radius: 999px;
      overflow: hidden;
      background: rgba(255,255,255,0.7);
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }

    .tab-button {
      flex: 1;
      padding: 8px 0;
      border: none;
      background: transparent;
      font-size: 0.9rem;
      font-weight: 600;
      color: #7a5a3a;
    }

    .tab-button.active {
      background: linear-gradient(135deg, var(--main-blue), #b0f0ff);
      color: #3b2a18;
    }

    main {
      position: relative;
      z-index: 1;
    }

    .view {
      display: none;
      animation: fadeIn 0.25s ease-out;
    }

    .view.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card {
      background: rgba(255,255,255,0.9);
      border-radius: var(--card-radius);
      padding: 14px 12px 16px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.12);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at 10% 20%, rgba(95,211,255,0.18) 0, transparent 55%),
        radial-gradient(circle at 80% 0%, rgba(139,90,43,0.12) 0, transparent 55%);
      opacity: 0.9;
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 1;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .card-title {
      font-weight: 700;
      font-size: 1.05rem;
      color: var(--main-brown);
    }

    .badge-status {
      font-size: 0.8rem;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(95,211,255,0.16);
      color: #3b2a18;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      white-space: nowrap;
    }

    .badge-status.complete {
      background: linear-gradient(135deg, #ffe66d, #ffc857);
      color: #5a3b00;
    }

    .stamp-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 6px;
      margin: 10px 0 8px;
    }

    .stamp-slot {
      width: 100%;
      padding-top: 100%;
      position: relative;
      border-radius: 10px;
      background: rgba(255,255,255,0.9);
      border: 2px dashed rgba(139,90,43,0.35);
      overflow: hidden;
      box-shadow: 0 1px 2px rgba(0,0,0,0.08);
    }

    .stamp-slot-inner {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
      color: #c7b29a;
      transition: transform 0.15s ease-out;
    }

    .stamp-slot.filled {
      border-style: solid;
      border-color: var(--main-brown);
      background: radial-gradient(circle at 30% 0%, #ffe9c7 0, #ffe0b5 40%, #ffd29a 100%);
    }

    .stamp-slot.filled .stamp-slot-inner {
      color: #5a3b00;
      transform: scale(1.05);
    }

    .controls {
      display: flex;
      gap: 8px;
      margin-top: 6px;
    }

    .btn {
      flex: 1;
      border-radius: 999px;
      border: none;
      padding: 10px 8px;
      font-size: 0.9rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      cursor: pointer;
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out, background 0.15s;
      box-shadow: 0 2px 4px rgba(0,0,0,0.16);
    }

    .btn:active {
      transform: translateY(1px) scale(0.98);
      box-shadow: 0 1px 2px rgba(0,0,0,0.18);
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--main-blue), #9ff0ff);
      color: #2b1a0a;
    }

    .btn-secondary {
      background: linear-gradient(135deg, #e0d0c0, #f3e4d3);
      color: #4a2b16;
    }

    .btn-small {
      flex: 0 0 auto;
      padding: 6px 10px;
      font-size: 0.8rem;
      box-shadow: none;
      background: rgba(255,255,255,0.8);
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.06);
      cursor: pointer;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
      font-size: 0.78rem;
      color: #6b4a2a;
      flex-wrap: wrap;
      gap: 4px;
    }

    .last-stamp {
      font-weight: 500;
    }

    .elapsed {
      font-size: 0.76rem;
      opacity: 0.9;
    }

    .lifehack-box {
      margin-top: 10px;
      background: rgba(255,255,255,0.9);
      border-radius: var(--card-radius);
      padding: 10px 10px 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.12);
      position: relative;
      overflow: hidden;
    }

    .lifehack-label {
      font-size: 0.8rem;
      font-weight: 700;
      color: var(--akane-red);
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-bottom: 4px;
    }

    .lifehack-text {
      font-size: 0.85rem;
      line-height: 1.4;
      color: #4a2b16;
    }

    .lifehack-box::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at 0% 100%, rgba(255,75,92,0.12) 0, transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(95,211,255,0.18) 0, transparent 55%);
      opacity: 0.9;
      pointer-events: none;
    }

    .lifehack-inner {
      position: relative;
      z-index: 1;
    }

    .history-view {
      background: rgba(255,255,255,0.9);
      border-radius: var(--card-radius);
      padding: 12px 10px 14px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.12);
      margin-top: 4px;
    }

    .history-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .history-title {
      font-size: 1rem;
      font-weight: 700;
      color: var(--main-brown);
    }

    .history-list {
      max-height: 320px;
      overflow-y: auto;
      margin-top: 4px;
      padding-right: 4px;
    }

    .history-item {
      padding: 6px 6px 6px 10px;
      border-radius: 10px;
      background: rgba(255,255,255,0.9);
      box-shadow: 0 1px 3px rgba(0,0,0,0.08);
      margin-bottom: 6px;
      font-size: 0.82rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    .history-item-main {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .history-item-label {
      font-weight: 600;
      color: #6b4a2a;
    }

    .history-item-time {
      font-size: 0.78rem;
      color: #7a5a3a;
    }

    .history-item-badge {
      font-size: 0.7rem;
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(95,211,255,0.18);
      color: #3b2a18;
      white-space: nowrap;
    }

    .floating-poop {
      position: fixed;
      font-size: 1.4rem;
      opacity: 0.35;
      animation: floatUp 12s linear infinite;
      pointer-events: none;
      z-index: 0;
    }

    @keyframes floatUp {
      0% { transform: translateY(100vh) translateX(0); opacity: 0; }
      10% { opacity: 0.35; }
      90% { opacity: 0.35; }
      100% { transform: translateY(-20vh) translateX(-10px); opacity: 0; }
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.35);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 20;
    }

    .modal-backdrop.active {
      display: flex;
    }

    .modal {
      width: 90%;
      max-width: 360px;
      background: #fffdf8;
      border-radius: 18px;
      padding: 14px 14px 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
      position: relative;
      overflow: hidden;
    }

    .modal::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at 0% 0%, rgba(255,75,92,0.18) 0, transparent 55%),
        radial-gradient(circle at 100% 100%, rgba(95,211,255,0.18) 0, transparent 55%);
      opacity: 0.9;
      pointer-events: none;
    }

    .modal-inner {
      position: relative;
      z-index: 1;
    }

    .modal-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }

    .modal-title {
      font-size: 1rem;
      font-weight: 700;
      color: #4a2b16;
    }

    .modal-message {
      font-size: 0.9rem;
      line-height: 1.5;
      margin-top: 4px;
      color: #4a2b16;
    }

    .modal-footer {
      margin-top: 10px;
      display: flex;
      justify-content: flex-end;
    }

    .modal-close-btn {
      border-radius: 999px;
      border: none;
      padding: 6px 14px;
      font-size: 0.85rem;
      font-weight: 600;
      background: rgba(255,255,255,0.9);
      color: #4a2b16;
      box-shadow: 0 2px 4px rgba(0,0,0,0.16);
      cursor: pointer;
    }

    .modal-badge {
      margin-top: 6px;
      padding: 6px 8px;
      border-radius: 12px;
      background: rgba(255,255,255,0.9);
      font-size: 0.82rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: #5a3b00;
    }

    .modal-badge span {
      font-weight: 700;
    }

    .sparkle {
      position: absolute;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: radial-gradient(circle, #fff 0, #ffe66d 40%, transparent 70%);
      opacity: 0;
      animation: sparkle 1.2s ease-out forwards;
      pointer-events: none;
      z-index: 5;
    }

    @keyframes sparkle {
      0% { transform: scale(0.2); opacity: 0; }
      30% { transform: scale(1); opacity: 1; }
      100% { transform: scale(0.1); opacity: 0; }
    }

    footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      text-align: center;
      font-size: 0.75rem;
      padding: 6px 0 8px;
      color: #6b4a2a;
      background: linear-gradient(to top, rgba(255,247,233,0.96), rgba(255,247,233,0.0));
      z-index: 5;
    }

    @media (min-height: 700px) {
      .app {
        padding-top: 16px;
      }
      .card {
        margin-top: 4px;
      }
      .lifehack-box {
        margin-top: 14px;
      }
    }
  </style>
</head>
<body>
  <!-- æ¼‚ã†ã†ã‚“ã‚‚ã‚‰ -->
  <div class="floating-poop" style="left: 8%; animation-delay: 0s;">ğŸ’©</div>
  <div class="floating-poop" style="left: 26%; font-size:1.2rem; animation-delay: 3s;">ğŸ’©</div>
  <div class="floating-poop" style="left: 52%; font-size:1.6rem; animation-delay: 6s;">ğŸ’©</div>
  <div class="floating-poop" style="left: 74%; font-size:1.3rem; animation-delay: 1.5s;">ğŸ’©</div>
  <div class="floating-poop" style="left: 90%; font-size:1.1rem; animation-delay: 4.5s;">ğŸ’©</div>

  <div class="app">
    <header>
      <h1>ã†ã‚“ã‚‚ã‚‰ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰</h1>
      <div class="subtitle">æ¥½ã—ãå¥åº·çš„ã«ã€ä»Šæ—¥ã‚‚ãƒŠã‚¤ã‚¹ã†ã‚“ã‚‚ã‚‰ã€‚</div>
      <div class="akane-badge">
        <div class="akane-icon">èŒœ</div>
        <span>è‰²å¤‰èŒœãŒã‚ãªãŸã®è…¸æ´»ã‚’å…¨åŠ›å¿œæ´ä¸­ï¼</span>
      </div>

      <div class="tab-nav">
        <button class="tab-button active" data-target="card-view">ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰</button>
        <button class="tab-button" data-target="history-view">ã†ã‚“ã‚‚ã‚‰å±¥æ­´</button>
      </div>
    </header>

    <main>
      <!-- ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰ãƒ“ãƒ¥ãƒ¼ -->
      <section id="card-view" class="view active">
        <div class="card">
          <div class="card-inner">
            <div class="card-header">
              <div class="card-title">ä»Šæ—¥ã‚‚1ã†ã‚“ã‚‚ã‚‰ã€ã„ã£ã¨ãï¼Ÿ</div>
              <div id="badgeStatus" class="badge-status">
                <span>é€²æ—ï¼š</span><span id="stampCountLabel">0 / 10</span>
              </div>
            </div>

            <div class="stamp-grid" id="stampGrid">
              <!-- JSã§10å€‹ç”Ÿæˆ -->
            </div>

            <div class="controls">
              <button id="stampButton" class="btn btn-primary">
                <span>ã†ã‚“ã‚‚ã‚‰ã—ãŸï¼</span>
              </button>
              <button id="resetButton" class="btn btn-secondary">
                <span>ãƒªã‚»ãƒƒãƒˆ</span>
              </button>
            </div>

            <div class="info-row">
              <div class="last-stamp">
                æœ€å¾Œã®ã†ã‚“ã‚‚ã‚‰ï¼š
                <span id="lastStampText">ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</span>
              </div>
              <div class="elapsed">
                çµŒéæ™‚é–“ï¼š<span id="elapsedTime">--</span>
              </div>
            </div>
          </div>
        </div>

        <div class="lifehack-box">
          <div class="lifehack-inner">
            <div class="lifehack-label">
              <div class="akane-icon" style="width:22px;height:22px;font-size:0.8rem;">èŒœ</div>
              <span>èŒœã®ãƒ©ã‚¤ãƒ•ãƒãƒƒã‚¯</span>
            </div>
            <div id="lifehackText" class="lifehack-text">
              èª°ã«ã‚‚è¨€ã‚ãªã„ã‘ã©ã€ãƒˆã‚¤ãƒ¬ã§æ·±å‘¼å¸ã™ã‚‹ã¨ã¡ã‚‡ã£ã¨ã ã‘è³¢ããªã£ãŸæ°—ãŒã™ã‚‹ã‚ˆã€‚ï¼ˆè‡­ã„ã‘ã©ï¼‰
            </div>
          </div>
        </div>
      </section>

      <!-- å±¥æ­´ãƒ“ãƒ¥ãƒ¼ -->
      <section id="history-view" class="view">
        <div class="history-view">
          <div class="history-header">
            <div class="history-title">ã†ã‚“ã‚‚ã‚‰å±¥æ­´</div>
            <button id="clearHistoryButton" class="btn btn-small">å±¥æ­´ã‚’å…¨éƒ¨æ¶ˆã™</button>
          </div>
          <div class="history-list" id="historyList">
            <div style="font-size:0.82rem; color:#7a5a3a; padding:4px 2px;">
              ã¾ã ã†ã‚“ã‚‚ã‚‰ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚<br>
              ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰ã‹ã‚‰ã€Œã†ã‚“ã‚‚ã‚‰ã—ãŸï¼ã€ã‚’æŠ¼ã—ã¦ã¿ã‚ˆã†ã€‚
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- èŒœã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal">
      <div class="modal-inner">
        <div class="modal-header">
          <div class="akane-icon">èŒœ</div>
          <div class="modal-title" id="modalTitle">èŒœã‹ã‚‰ã®ã‚ã‚ŠãŒãŸã„ãŠè¨€è‘‰</div>
        </div>
        <div class="modal-message" id="modalMessage">
          ä»Šæ—¥ã®ã†ã‚“ã‚‚ã‚‰ã€ãƒŠã‚¤ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ã ã£ãŸã‚ˆã€‚
        </div>
        <div id="modalBadgeArea"></div>
        <div class="modal-footer">
          <button id="modalCloseButton" class="modal-close-btn">ã‚ã‚ŠãŒãŸãé–‰ã˜ã‚‹</button>
        </div>
      </div>
    </div>
  </div>

  <footer>
    Â© 2026 Unmora Project
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // --- ãƒ‡ãƒ¼ã‚¿ ---
      const akaneMessages = [
        "ä»Šæ—¥ã®ã†ã‚“ã‚‚ã‚‰ã€ãƒŠã‚¤ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ã ã£ãŸã‚ˆã€‚èƒŒç­‹ã‚‚å¿ƒã‚‚ã¾ã£ã™ãã ã­ã€‚",
        "ã†ã‚“ã‚‚ã‚‰ã¯æˆ‘æ…¢ã—ãªã„ã®ãŒã„ã¡ã°ã‚“ã®ã‚ªã‚·ãƒ£ãƒ¬ã ã‚ˆã€‚",
        "ãƒˆã‚¤ãƒ¬ã«è¡Œã‘ãŸè‡ªåˆ†ã‚’ã¡ã‚ƒã‚“ã¨è¤’ã‚ã¦ã‚ã’ã¦ã­ã€‚ãˆã‚‰ã„ï¼",
        "æ°´ã‚’ä¸€å£é£²ã‚“ã§ã€è…¸ã«ã‚‚æ‹æ‰‹ã—ã¦ã‚ã’ã‚ˆã£ã‹ã€‚",
        "ä»Šæ—¥ã®ã†ã‚“ã‚‚ã‚‰ã§ã€æ˜¨æ—¥ã®è‡ªåˆ†ã‚ˆã‚Š1ãƒŸãƒªå¥åº·ã«ãªã£ãŸã‚ˆã€‚",
        "ã‚¹ãƒãƒ›ã‚’ç½®ã„ã¦ã†ã‚“ã‚‚ã‚‰ã™ã‚‹ã¨ã€ãªãœã‹ã‚¢ã‚¤ãƒ‡ã‚¢ãŒé™ã£ã¦ãã‚‹â€¦ã‹ã‚‚ã—ã‚Œãªã„ã‚ˆã€‚",
        "ã†ã‚“ã‚‚ã‚‰ã®éŸ³ã¯ã€èº«ä½“ã‹ã‚‰ã®ã€ä»Šæ—¥ã‚‚å‹•ã„ã¦ã‚‹ã‚ˆã€ã£ã¦ã„ã†åˆå›³ãªã‚“ã ã£ã¦ã€‚",
        "ãƒˆã‚¤ãƒ¬ã‹ã‚‰å‡ºã‚‹ã¨ãã€ã¡ã‚‡ã£ã¨ã ã‘èƒ¸ã‚’å¼µã£ã¦æ­©ã„ã¦ã¿ã¦ã€‚è‡ªä¿¡å‡ºã‚‹ã‹ã‚‰ã€‚",
        "ã†ã‚“ã‚‚ã‚‰ã®ãƒªã‚ºãƒ ã¯ã€ç”Ÿæ´»ãƒªã‚ºãƒ ã®é¡ãªã‚“ã ã‚ˆã€‚ä»Šæ—¥ã‚‚ã„ã„ãƒ†ãƒ³ãƒï¼",
        "å‡ºãªã‹ã£ãŸæ—¥ãŒã‚ã£ã¦ã‚‚å¤§ä¸ˆå¤«ã€‚èŒœã¯ã‚ãªãŸã®å‘³æ–¹ã ã‹ã‚‰ã­ã€‚"
      ];

      const akaneLifehacks = [
        "ãƒˆã‚¤ãƒ¬ã«å…¥ã‚‹å‰ã«ã€æ·±å‘¼å¸ã‚’3å›ã™ã‚‹ã¨ã€ãªãœã‹ã¡ã‚‡ã£ã¨ãƒ—ãƒ­ã£ã½ã„æ°—åˆ†ã«ãªã‚Œã‚‹ã‚ˆã€‚",
        "ãƒˆã‚¤ãƒ¬ã®ãƒ‰ã‚¢ã‚’é™ã‹ã«é–‰ã‚ã‚‹ã¨ã€ãªãœã‹ã†ã‚“ã‚‚ã‚‰ã‚‚ä¸Šå“ã«ãªã‚‹â€¦æ°—ãŒã™ã‚‹ã ã‘ã ã‚ˆã€‚",
        "ã†ã‚“ã‚‚ã‚‰å‰ã«ã€ä»Šæ—¥ã‚‚ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã€ã£ã¦å¿ƒã®ä¸­ã§è¨€ã†ã¨ã€ã¡ã‚‡ã£ã¨ä»²è‰¯ããªã‚Œã‚‹ã‚ˆã€‚",
        "ãƒˆã‚¤ãƒ¬ã®é›»æ°—ã‚’ã¤ã‘ã‚‹ã¨ãã€è»½ãã‚¹ãƒˆãƒ¬ãƒƒãƒã™ã‚‹ã¨ã€ãªã‚“ã‹å¥åº·ã£ã½ã„é›°å›²æ°—ãŒå‡ºã‚‹ã‚ˆã€‚",
        "ãƒˆã‚¤ãƒ¬ã®åºŠã®ã‚¿ã‚¤ãƒ«ã‚’æ•°ãˆã¦ã„ã‚‹ã¨ã€æ°—ã¥ã„ãŸã‚‰ã†ã‚“ã‚‚ã‚‰ãŒçµ‚ã‚ã£ã¦ã‚‹ã“ã¨ãŒã‚ã‚‹ã‚ˆã€‚",
        "ã†ã‚“ã‚‚ã‚‰ã®ã‚ã¨ã€é¡ã‚’è¦‹ã¦ãƒ‹ãƒ¤ãƒƒã¨ã™ã‚‹ã¨ã€1æ—¥ã®ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãŒ0.5ä¸ŠãŒã‚‹ã‚‰ã—ã„ã‚ˆã€‚ï¼ˆèŒœèª¿ã¹ï¼‰",
        "ãƒˆã‚¤ãƒ¬ã«ãŠæ°—ã«å…¥ã‚Šã®é¦™ã‚Šã‚’1ã¤ç½®ã„ã¦ãŠãã¨ã€ã†ã‚“ã‚‚ã‚‰ãŒã¡ã‚‡ã£ã¨ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã«ãªã‚‹ã‚ˆã€‚",
        "ãƒˆã‚¤ãƒ¬ã‹ã‚‰å‡ºã‚‹ã¨ãã«ã€ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã€ã£ã¦å¿ƒã®ä¸­ã§è¨€ã†ã¨ã€ã¡ã‚‡ã£ã¨å¼·ããªã£ãŸæ°—ãŒã™ã‚‹ã‚ˆã€‚",
        "ã†ã‚“ã‚‚ã‚‰ã®å‰ã«è¶³é¦–ã‚’ãã‚‹ãã‚‹å›ã™ã¨ã€ãªã‚“ã‹é€šã£ã½ã„æ„Ÿã˜ãŒã™ã‚‹ã‚ˆã­ã€‚",
        "ãƒˆã‚¤ãƒ¬ã®æ™‚é–“ã‚’ã€è‡ªåˆ†ä¼šè­°ã‚¿ã‚¤ãƒ ã€ã£ã¦å‘¼ã¶ã¨ã€æ€¥ã«å¤§äº‹ãªæ™‚é–“ã£ã½ããªã‚‹ã‚ˆã€‚"
      ];

      // --- DOMå–å¾— ---
      const stampGrid = document.getElementById("stampGrid");
      const stampButton = document.getElementById("stampButton");
      const resetButton = document.getElementById("resetButton");
      const clearHistoryButton = document.getElementById("clearHistoryButton");
      const badgeStatus = document.getElementById("badgeStatus");
      const stampCountLabel = document.getElementById("stampCountLabel");
      const lastStampText = document.getElementById("lastStampText");
      const elapsedTime = document.getElementById("elapsedTime");
      const lifehackText = document.getElementById("lifehackText");
      const historyList = document.getElementById("historyList");
      const tabButtons = document.querySelectorAll(".tab-button");
      const views = document.querySelectorAll(".view");

      const modalBackdrop = document.getElementById("modalBackdrop");
      const modalTitle = document.getElementById("modalTitle");
      const modalMessage = document.getElementById("modalMessage");
      const modalBadgeArea = document.getElementById("modalBadgeArea");
      const modalCloseButton = document.getElementById("modalCloseButton");

      // --- çŠ¶æ…‹ ---
      let stampCount = 0;
      let lastStampDate = null;
      let elapsedTimerId = null;
      let history = [];

      // --- åˆæœŸåŒ– ---
      function initStampGrid() {
        stampGrid.innerHTML = "";
        for (let i = 0; i < 10; i++) {
          const slot = document.createElement("div");
          slot.className = "stamp-slot";
          slot.dataset.index = i;
          const inner = document.createElement("div");
          inner.className = "stamp-slot-inner";
          inner.textContent = "ğŸ’©";
          slot.appendChild(inner);
          stampGrid.appendChild(slot);
        }
      }

      function updateStampGrid() {
        const slots = stampGrid.querySelectorAll(".stamp-slot");
        slots.forEach((slot, index) => {
          if (index < stampCount) {
            slot.classList.add("filled");
          } else {
            slot.classList.remove("filled");
          }
        });
        stampCountLabel.textContent = `${stampCount} / 10`;
        if (stampCount >= 10) {
          badgeStatus.classList.add("complete");
          badgeStatus.textContent = "ğŸ‰ ã‚¹ãƒšã‚·ãƒ£ãƒ«ã†ã‚“ã‚‚ã‚‰ãƒãƒƒã‚¸é”æˆï¼";
        } else {
          badgeStatus.classList.remove("complete");
          badgeStatus.innerHTML = `é€²æ—ï¼š<span id="stampCountLabel">${stampCount} / 10</span>`;
        }
      }

      function formatDateTime(date) {
        const y = date.getFullYear();
        const m = String(date.getMonth() + 1).padStart(2, "0");
        const d = String(date.getDate()).padStart(2, "0");
        const hh = String(date.getHours()).padStart(2, "0");
        const mm = String(date.getMinutes()).padStart(2, "0");
        const ss = String(date.getSeconds()).padStart(2, "0");
        return `${y}/${m}/${d} ${hh}:${mm}:${ss}`;
      }

      function updateElapsedTime() {
        if (!lastStampDate) {
          elapsedTime.textContent = "--";
          return;
        }
        const now = new Date();
        const diffMs = now - lastStampDate;
        if (diffMs < 0) {
          elapsedTime.textContent = "--";
          return;
        }
        const totalSec = Math.floor(diffMs / 1000);
        const hours = Math.floor(totalSec / 3600);
        const minutes = Math.floor((totalSec % 3600) / 60);
        const seconds = totalSec % 60;

        let text = "";
        if (hours > 0) text += `${hours}æ™‚é–“`;
        if (minutes > 0 || hours > 0) text += `${minutes}åˆ†`;
        text += `${seconds}ç§’`;
        elapsedTime.textContent = text + " çµŒé";
      }

      function startElapsedTimer() {
        if (elapsedTimerId) clearInterval(elapsedTimerId);
        elapsedTimerId = setInterval(updateElapsedTime, 1000);
      }

      function stopElapsedTimer() {
        if (elapsedTimerId) {
          clearInterval(elapsedTimerId);
          elapsedTimerId = null;
        }
      }

      function addHistoryEntry(date, count) {
        const entry = {
          timestamp: date.toISOString(),
          label: `ã†ã‚“ã‚‚ã‚‰ #${count}`,
        };
        history.unshift(entry);
        renderHistory();
      }

      function renderHistory() {
        historyList.innerHTML = "";
        if (history.length === 0) {
          const empty = document.createElement("div");
          empty.style.fontSize = "0.82rem";
          empty.style.color = "#7a5a3a";
          empty.style.padding = "4px 2px";
          empty.innerHTML = "ã¾ã ã†ã‚“ã‚‚ã‚‰ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚<br>ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰ã‹ã‚‰ã€Œã†ã‚“ã‚‚ã‚‰ã—ãŸï¼ã€ã‚’æŠ¼ã—ã¦ã¿ã‚ˆã†ã€‚";
          historyList.appendChild(empty);
          return;
        }

        history.forEach((entry, index) => {
          const item = document.createElement("div");
          item.className = "history-item";

          const main = document.createElement("div");
          main.className = "history-item-main";

          const label = document.createElement("div");
          label.className = "history-item-label";
          label.textContent = entry.label;

          const time = document.createElement("div");
          time.className = "history-item-time";
          const date = new Date(entry.timestamp);
          time.textContent = formatDateTime(date);

          main.appendChild(label);
          main.appendChild(time);

          const badge = document.createElement("div");
          badge.className = "history-item-badge";
          if ((index + 1) % 10 === 0) {
            badge.textContent = "ã‚¹ãƒšã‚·ãƒ£ãƒ«ã†ã‚“ã‚‚ã‚‰ãƒãƒƒã‚¸å›ï¼";
          } else {
            badge.textContent = "ã†ã‚“ã‚‚ã‚‰æ—¥ã‚ˆã‚Šèªå®šæ¸ˆ";
          }

          item.appendChild(main);
          item.appendChild(badge);
          historyList.appendChild(item);
        });
      }

      function randomFromArray(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
      }

      function updateLifehack() {
        lifehackText.textContent = randomFromArray(akaneLifehacks);
      }

      function showModal(message, isBadgeCelebration = false) {
        modalTitle.textContent = isBadgeCelebration
          ? "ã‚¹ãƒšã‚·ãƒ£ãƒ«ã†ã‚“ã‚‚ã‚‰ãƒãƒƒã‚¸ãŠã‚ã§ã¨ã†ï¼"
          : "èŒœã‹ã‚‰ã®ã‚ã‚ŠãŒãŸã„ãŠè¨€è‘‰";
        modalMessage.textContent = message;

        modalBadgeArea.innerHTML = "";
        if (isBadgeCelebration) {
          const badge = document.createElement("div");
          badge.className = "modal-badge";
          badge.innerHTML = "ğŸ’©<span>ã‚¹ãƒšã‚·ãƒ£ãƒ«ã†ã‚“ã‚‚ã‚‰ãƒãƒƒã‚¸</span> ã‚’æˆä¸ã—ã¾ã™ï¼";
          modalBadgeArea.appendChild(badge);

          for (let i = 0; i < 8; i++) {
            const sparkle = document.createElement("div");
            sparkle.className = "sparkle";
            sparkle.style.left = 20 + Math.random() * 60 + "%";
            sparkle.style.top = 20 + Math.random() * 50 + "%";
            modalBackdrop.appendChild(sparkle);
            setTimeout(() => sparkle.remove(), 1300);
          }
        }

        modalBackdrop.classList.add("active");
      }

      function hideModal() {
        modalBackdrop.classList.remove("active");
      }

      function handleStamp() {
        const now = new Date();

        if (stampCount < 10) {
          stampCount++;
        } else {
          stampCount = 1;
        }
        updateStampGrid();

        lastStampDate = now;
        lastStampText.textContent = formatDateTime(now);
        startElapsedTimer();
        updateElapsedTime();

        addHistoryEntry(now, history.length + 1);
        updateLifehack();

        const baseMessage = randomFromArray(akaneMessages);
        if (stampCount === 10) {
          const extra = " ã“ã‚Œã§ä»Šæ—¥ã®ã‚ãªãŸã¯ã€ã†ã‚“ã‚‚ã‚‰ãƒã‚¹ã‚¿ãƒ¼ã€ã ã‚ˆï¼";
          showModal(baseMessage + extra, true);
        } else {
          showModal(baseMessage, false);
        }
      }

      function handleReset() {
        stampCount = 0;
        updateStampGrid();
        lastStampDate = null;
        lastStampText.textContent = "ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“";
        stopElapsedTimer();
        elapsedTime.textContent = "--";
      }

      function handleClearHistory() {
        history = [];
        renderHistory();
      }

      function setupTabs() {
        tabButtons.forEach(btn => {
          btn.addEventListener("click", () => {
            const targetId = btn.dataset.target;
            tabButtons.forEach(b => b.classList.remove("active"));
            btn.classList.add("active");
            views.forEach(v => {
              if (v.id === targetId) {
                v.classList.add("active");
              } else {
                v.classList.remove("active");
              }
            });
          });
        });
      }

      // --- ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ² ---
      if (stampButton) stampButton.addEventListener("click", handleStamp);
      if (resetButton) resetButton.addEventListener("click", handleReset);
      if (clearHistoryButton) clearHistoryButton.addEventListener("click", handleClearHistory);
      if (modalCloseButton) modalCloseButton.addEventListener("click", hideModal);
      if (modalBackdrop) {
        modalBackdrop.addEventListener("click", (e) => {
          if (e.target === modalBackdrop) hideModal();
        });
      }

      // --- èµ·å‹• ---
      initStampGrid();
      updateStampGrid();
      renderHistory();
      updateLifehack();
      setupTabs();
    });
  </script>
</body>
</html>
