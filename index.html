<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ã†ã‚“ã‚‚ã‚‰ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰ - Unmora Project</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --brown: #8b5a2b;
      --light-brown: #c58f5c;
      --aqua: #6fd6ff;
      --aqua-light: #b8ecff;
      --akane-red: #e53935;
      --bg: #fffaf3;
      --card-bg: #ffffff;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
      --radius: 16px;
      --transition: 0.25s ease;
      --font-main: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: var(--font-main);
      background: radial-gradient(circle at top, #fef6e8 0, #fdf0dd 40%, #fbe7cf 100%);
      color: #3b2a1a;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      padding: 12px;
    }

    .app {
      width: 100%;
      max-width: 480px;
      background: linear-gradient(180deg, #fffdf8 0, #fff7ea 40%, #fffaf3 100%);
      border-radius: 24px;
      box-shadow: var(--shadow);
      padding: 16px 14px 12px;
      position: relative;
      overflow: hidden;
    }

    header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .akane-avatar {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 20%, #ffebee 0, #ffcdd2 40%, #e53935 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 800;
      font-size: 18px;
      box-shadow: 0 3px 8px rgba(229, 57, 53, 0.4);
      flex-shrink: 0;
    }

    .title-block {
      flex: 1;
    }

    .title-block h1 {
      font-size: 20px;
      margin: 0;
      color: var(--brown);
      letter-spacing: 0.03em;
    }

    .title-block p {
      margin: 2px 0 0;
      font-size: 11px;
      color: #6b4a2a;
    }

    .tagline {
      font-size: 11px;
      color: #8b5a2b;
      margin-top: 4px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(111, 214, 255, 0.18);
    }

    .tab-bar {
      display: flex;
      gap: 6px;
      margin: 8px 0 10px;
      padding: 4px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 999px;
    }

    .tab-btn {
      flex: 1;
      border: none;
      border-radius: 999px;
      padding: 7px 4px;
      font-size: 12px;
      font-weight: 600;
      background: transparent;
      color: #7a5a3a;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      cursor: pointer;
      transition: var(--transition);
    }

    .tab-btn.active {
      background: linear-gradient(135deg, var(--aqua) 0, var(--aqua-light) 100%);
      color: #2b3a4a;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
    }

    .tab-btn span.icon {
      font-size: 14px;
    }

    main {
      position: relative;
      z-index: 1;
    }

    .page {
      display: none;
      animation: fadeIn 0.25s ease;
    }

    .page.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 12px 12px 10px;
      box-shadow: var(--shadow);
      margin-bottom: 10px;
      position: relative;
      overflow: hidden;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .card-header h2 {
      margin: 0;
      font-size: 15px;
      color: var(--brown);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .card-header h2 span {
      font-size: 18px;
    }

    .badge-pill {
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(139, 90, 43, 0.08);
      color: #7a4a1f;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .badge-pill strong {
      font-size: 11px;
    }

    .stamp-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 6px;
      margin-top: 6px;
    }

    .stamp-slot {
      width: 100%;
      aspect-ratio: 1 / 1;
      border-radius: 10px;
      border: 2px dashed rgba(139, 90, 43, 0.35);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: rgba(139, 90, 43, 0.4);
      background: linear-gradient(135deg, #fffaf3 0, #fff3e0 100%);
      position: relative;
      overflow: hidden;
    }

    .stamp-slot.filled {
      border-style: solid;
      border-color: rgba(111, 214, 255, 0.9);
      background: radial-gradient(circle at 30% 20%, #fff 0, #e0f8ff 40%, #b8ecff 100%);
      color: #5b3a1a;
      animation: popStamp 0.3s ease;
    }

    .stamp-slot.filled::after {
      content: "æ¸ˆ";
      position: absolute;
      bottom: 2px;
      right: 4px;
      font-size: 10px;
      color: rgba(90, 58, 26, 0.7);
    }

    @keyframes popStamp {
      0% {
        transform: scale(0.6) rotate(-8deg);
        opacity: 0;
      }
      70% {
        transform: scale(1.05) rotate(2deg);
        opacity: 1;
      }
      100% {
        transform: scale(1) rotate(0deg);
      }
    }

    .stamp-count-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
      font-size: 11px;
      color: #6b4a2a;
    }

    .stamp-count-row strong {
      font-size: 12px;
      color: var(--brown);
    }

    .progress-bar {
      position: relative;
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background: rgba(139, 90, 43, 0.12);
      overflow: hidden;
      margin-top: 4px;
    }

    .progress-fill {
      position: absolute;
      inset: 0;
      width: 0%;
      background: linear-gradient(90deg, var(--aqua) 0, var(--aqua-light) 100%);
      transition: width 0.25s ease;
    }

    .action-row {
      display: flex;
      gap: 8px;
      margin-bottom: 10px;
    }

    .btn-main {
      flex: 1;
      border: none;
      border-radius: 999px;
      padding: 10px 10px;
      font-size: 14px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--aqua) 0, var(--aqua-light) 100%);
      color: #1f3440;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.18);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      cursor: pointer;
      transition: var(--transition);
    }

    .btn-main:active {
      transform: translateY(1px) scale(0.99);
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.18);
    }

    .btn-sub {
      border-radius: 999px;
      border: none;
      padding: 8px 10px;
      font-size: 11px;
      background: rgba(139, 90, 43, 0.08);
      color: #6b4a2a;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
      transition: var(--transition);
      white-space: nowrap;
    }

    .btn-sub:active {
      transform: translateY(1px);
    }

    .lifehack-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: var(--radius);
      padding: 8px 10px;
      box-shadow: var(--shadow);
      margin-bottom: 10px;
      display: flex;
      gap: 8px;
      align-items: flex-start;
    }

    .lifehack-label {
      font-size: 11px;
      font-weight: 700;
      color: var(--akane-red);
      padding: 3px 7px;
      border-radius: 999px;
      background: rgba(229, 57, 53, 0.08);
      margin-bottom: 3px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .lifehack-text {
      font-size: 12px;
      color: #4a3420;
      line-height: 1.5;
    }

    .lifehack-akane {
      flex-shrink: 0;
      width: 40px;
      height: 40px;
      border-radius: 14px;
      background: radial-gradient(circle at 30% 20%, #ffebee 0, #ffcdd2 40%, #e53935 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 800;
      font-size: 14px;
    }

    .info-row {
      font-size: 11px;
      color: #6b4a2a;
      margin-bottom: 6px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .info-row span {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .info-row strong {
      color: var(--brown);
    }

    .elapsed {
      font-size: 11px;
      color: #8b5a2b;
      margin-bottom: 4px;
    }

    .elapsed span {
      font-weight: 600;
    }

    .history-summary {
      font-size: 12px;
      color: #5b3a1a;
      margin-bottom: 6px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .history-list {
      max-height: 260px;
      overflow-y: auto;
      padding-right: 4px;
      margin-top: 4px;
    }

    .history-item {
      font-size: 12px;
      padding: 6px 8px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.9);
      margin-bottom: 4px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
    }

    .history-item span.label {
      font-size: 11px;
      color: #8b5a2b;
    }

    .history-empty {
      font-size: 12px;
      color: #9b7a5a;
      text-align: center;
      padding: 10px 0;
    }

    .footer {
      font-size: 10px;
      text-align: center;
      color: #8b5a2b;
      margin-top: 4px;
      padding-top: 4px;
      border-top: 1px dashed rgba(139, 90, 43, 0.3);
    }

    .floating-poop {
      position: absolute;
      font-size: 20px;
      opacity: 0.18;
      animation: floatPoop 12s linear infinite;
      pointer-events: none;
      z-index: 0;
    }

    @keyframes floatPoop {
      0% {
        transform: translateY(0) translateX(0) rotate(0deg);
      }
      50% {
        transform: translateY(-18px) translateX(6px) rotate(6deg);
      }
      100% {
        transform: translateY(0) translateX(0) rotate(0deg);
      }
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.35);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 20;
      padding: 16px;
    }

    .modal-backdrop.active {
      display: flex;
    }

    .modal {
      width: 100%;
      max-width: 360px;
      background: #fffdf8;
      border-radius: 20px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
      padding: 14px 14px 12px;
      position: relative;
      overflow: hidden;
    }

    .modal-akane {
      position: absolute;
      top: -22px;
      right: -10px;
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 20%, #ffebee 0, #ffcdd2 40%, #e53935 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 800;
      font-size: 16px;
      box-shadow: 0 4px 10px rgba(229, 57, 53, 0.5);
      transform: rotate(10deg);
    }

    .modal-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }

    .modal-header h3 {
      margin: 0;
      font-size: 15px;
      color: var(--brown);
    }

    .modal-body {
      font-size: 13px;
      color: #4a3420;
      line-height: 1.6;
      margin-bottom: 8px;
      padding-right: 10px;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 4px;
    }

    .btn-close {
      border-radius: 999px;
      border: none;
      padding: 7px 12px;
      font-size: 12px;
      background: linear-gradient(135deg, #ffe0b2 0, #ffcc80 100%);
      color: #5b3a1a;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .btn-secondary {
      border-radius: 999px;
      border: none;
      padding: 7px 12px;
      font-size: 12px;
      background: rgba(139, 90, 43, 0.08);
      color: #6b4a2a;
      cursor: pointer;
    }

    .modal-tag {
      font-size: 10px;
      color: var(--akane-red);
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(229, 57, 53, 0.08);
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-bottom: 4px;
    }

    .badge-celebration {
      font-size: 12px;
      color: #8b5a2b;
      margin-top: 4px;
    }

    .badge-celebration strong {
      color: var(--akane-red);
    }

    .reset-note {
      font-size: 11px;
      color: #6b4a2a;
      margin-top: 4px;
    }

    @media (max-width: 400px) {
      .app {
        border-radius: 18px;
        padding: 12px 10px 10px;
      }
      .stamp-grid {
        gap: 5px;
      }
      .btn-main {
        font-size: 13px;
        padding: 9px 8px;
      }
      .lifehack-card {
        padding: 7px 8px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- æ¼‚ã†ã†ã‚“ã¡ãŸã¡ -->
    <div class="floating-poop" style="top: 12%; left: 6%; animation-delay: 0s;">ğŸ’©</div>
    <div class="floating-poop" style="top: 26%; right: 10%; animation-delay: 2s;">ğŸ’©</div>
    <div class="floating-poop" style="bottom: 18%; left: 18%; animation-delay: 4s;">ğŸ’©</div>
    <div class="floating-poop" style="bottom: 6%; right: 4%; animation-delay: 6s;">ğŸ’©</div>
    <div class="floating-poop" style="top: 45%; left: 40%; font-size: 24px; animation-delay: 1s;">ğŸ’©</div>

    <header>
      <div class="akane-avatar">èŒœ</div>
      <div class="title-block">
        <h1>ã†ã‚“ã‚‚ã‚‰ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰</h1>
        <p>ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼šè‰²å¤‰èŒœï¼ˆã„ã‚ã‹ã‚ã‚ã‹ã­ï¼‰</p>
        <div class="tagline">
          <span>ğŸ’©</span>
          <span>ã†ã‚“ã‚‚ã‚‰ã‚’ã€ã¡ã‚‡ã£ã¨ã ã‘èª‡ã‚ã†ã€‚</span>
        </div>
      </div>
    </header>

    <div class="tab-bar">
      <button class="tab-btn active" data-tab="card">
        <span class="icon">ğŸ§»</span><span>ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰</span>
      </button>
      <button class="tab-btn" data-tab="history">
        <span class="icon">ğŸ“œ</span><span>ã†ã‚“ã‚‚ã‚‰å±¥æ­´</span>
      </button>
    </div>

    <main>
      <!-- ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ -->
      <section class="page active" id="page-card">
        <div class="card">
          <div class="card-header">
            <h2><span>ğŸ’©</span>å¥åº·ã†ã‚“ã‚‚ã‚‰è¨˜éŒ²</h2>
            <div class="badge-pill">
              <strong>ã‚¹ãƒšã‚·ãƒ£ãƒ«ã†ã‚“ã‚‚ã‚‰ãƒãƒƒã‚¸</strong>
              <span id="badgeCountLabel">Ã—0</span>
            </div>
          </div>
          <div class="stamp-grid" id="stampGrid">
            <!-- JSã§10å€‹ç”Ÿæˆ -->
          </div>
          <div class="stamp-count-row">
            <span><strong>ã‚¹ã‚¿ãƒ³ãƒ—ï¼š</strong><span id="stampCountLabel">0</span> / 10</span>
            <span><strong>ç´¯è¨ˆã†ã‚“ã‚‚ã‚‰ï¼š</strong><span id="totalUnmoraLabel">0</span> å›</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
        </div>

        <div class="action-row">
          <button class="btn-main" id="unmoraButton">
            <span>ğŸ’©</span><span>ã†ã‚“ã‚‚ã‚‰ã—ãŸï¼</span>
          </button>
          <button class="btn-sub" id="resetButton">
            <span>ğŸ§¼</span><span>ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ</span>
          </button>
        </div>

        <div class="lifehack-card">
          <div class="lifehack-akane">èŒœ</div>
          <div>
            <div class="lifehack-label">
              <span>ğŸ’¡</span><span>èŒœã®ãƒ©ã‚¤ãƒ•ãƒãƒƒã‚¯</span>
            </div>
            <div class="lifehack-text" id="lifehackText">
              æœã‚¤ãƒã®ã†ã‚“ã‚‚ã‚‰å‰ã«æ·±å‘¼å¸ã‚’3å›ã™ã‚‹ã¨ã€ãªã‚“ã¨ãªããƒ—ãƒ­ã£ã½ã„æ°—åˆ†ã«ãªã‚Œã¾ã™ã€‚
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2><span>â±</span>ã†ã‚“ã‚‚ã‚‰ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³</h2>
          </div>
          <div class="info-row">
            <span>
              <strong>æœ€å¾Œã®ã†ã‚“ã‚‚ã‚‰ï¼š</strong>
              <span id="lastUnmoraLabel">ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</span>
            </span>
          </div>
          <div class="elapsed" id="elapsedLabel">
            å‰å›ã®ã†ã‚“ã‚‚ã‚‰ã‹ã‚‰ã®çµŒéæ™‚é–“ï¼šâ€•
          </div>
          <div class="info-row">
            <span>
              <strong>ä»Šæ—¥ã®ã†ã‚“ã‚‚ã‚‰ï¼š</strong>
              <span id="todayCountLabel">0</span> å›
            </span>
            <span>
              <strong>ä»Šæœˆã®ã†ã‚“ã‚‚ã‚‰ï¼š</strong>
              <span id="monthCountLabel">0</span> å›
            </span>
          </div>
        </div>
      </section>

      <!-- å±¥æ­´ãƒšãƒ¼ã‚¸ -->
      <section class="page" id="page-history">
        <div class="card">
          <div class="card-header">
            <h2><span>ğŸ“œ</span>ã†ã‚“ã‚‚ã‚‰å±¥æ­´</h2>
          </div>
          <div class="history-summary">
            <span><strong>ç´¯è¨ˆã†ã‚“ã‚‚ã‚‰ï¼š</strong><span id="totalUnmoraLabelHistory">0</span> å›</span>
            <span><strong>ç´¯è¨ˆã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒãƒƒã‚¸ï¼š</strong><span id="badgeCountLabelHistory">0</span> å€‹</span>
          </div>
          <div class="history-list" id="historyList">
            <!-- JSã§å±¥æ­´ã‚’æç”» -->
          </div>
        </div>
      </section>
    </main>

    <div class="footer">
      Â© 2026 Unmora Project
    </div>
  </div>

  <!-- èŒœã®ã‚ã‚ŠãŒãŸã„ãŠè¨€è‘‰ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal-backdrop" id="akaneModalBackdrop">
    <div class="modal">
      <div class="modal-akane">èŒœ</div>
      <div class="modal-tag">
        <span>ğŸ¤</span><span>è‰²å¤‰èŒœã‹ã‚‰ã®ã‚ã‚ŠãŒãŸã„ãŠè¨€è‘‰</span>
      </div>
      <div class="modal-header">
        <h3>ã†ã‚“ã‚‚ã‚‰ã€ãŠã¤ã‹ã‚Œã•ã¾ï¼</h3>
      </div>
      <div class="modal-body" id="akaneMessage">
        ä»Šæ—¥ã‚‚ç«‹æ´¾ãªã†ã‚“ã‚‚ã‚‰ã€ä¸–ç•Œã®ã©ã“ã‹ã§èª°ã‹ãŒæ‹æ‰‹ã—ã¦ã¾ã™ã€‚ï¼ˆãŸã¶ã‚“ï¼‰
      </div>
      <div class="modal-footer">
        <button class="btn-close" id="akaneCloseButton">
          <span>ğŸ™</span><span>ã‚ã‚ŠãŒãŸãé–‰ã˜ã‚‹</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ã‚¹ãƒšã‚·ãƒ£ãƒ«ã†ã‚“ã‚‚ã‚‰ãƒãƒƒã‚¸ãŠç¥ã„ãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal-backdrop" id="badgeModalBackdrop">
    <div class="modal">
      <div class="modal-akane">èŒœ</div>
      <div class="modal-tag">
        <span>ğŸ…</span><span>ã‚¹ãƒšã‚·ãƒ£ãƒ«ã†ã‚“ã‚‚ã‚‰ãƒãƒƒã‚¸ç²å¾—ï¼</span>
      </div>
      <div class="modal-header">
        <h3>ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã€ãŠã‚ã§ã¨ã†ï¼</h3>
      </div>
      <div class="modal-body" id="badgeMessage">
        10å›ã®ã†ã‚“ã‚‚ã‚‰é”æˆï¼<br />
        ã‚ãªãŸã®è…¸ã€ä»Šæ—¥ã‚‚çµ¶å¥½èª¿ã€‚<br />
        ã€Œã‚¹ãƒšã‚·ãƒ£ãƒ«ã†ã‚“ã‚‚ã‚‰ãƒãƒƒã‚¸ã€ã‚’æˆä¸ã—ã¾ã™ï¼
        <div class="badge-celebration">
          <strong>âœ¨ èŒœã‚ˆã‚Šï¼š</strong> ã“ã“ã¾ã§æ¥ãŸã‚‰ã€ã‚‚ã†è…¸ã®è¦ªå‹ã ã­ã€‚
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-close" id="badgeCloseButton">
          <span>ğŸ™</span><span>ã‚ã‚ŠãŒãŸãé–‰ã˜ã‚‹</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ãƒªã‚»ãƒƒãƒˆç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ« -->
  <div class="modal-backdrop" id="resetModalBackdrop">
    <div class="modal">
      <div class="modal-akane">èŒœ</div>
      <div class="modal-tag">
        <span>ğŸ§¼</span><span>ãƒªã‚»ãƒƒãƒˆå‰ã®æœ€çµ‚ç¢ºèª</span>
      </div>
      <div class="modal-header">
        <h3>æœ¬å½“ã«å…¨éƒ¨ãƒªã‚»ãƒƒãƒˆã™ã‚‹ï¼Ÿ</h3>
      </div>
      <div class="modal-body">
        ã†ã‚“ã‚‚ã‚‰ã‚¹ã‚¿ãƒ³ãƒ—ã€å±¥æ­´ã€ãƒãƒƒã‚¸ã®æ•°ãªã©ã€<br />
        <strong>ã™ã¹ã¦ã®è¨˜éŒ²ãŒ0ã«ãªã‚Šã¾ã™ã€‚</strong><br />
        ã†ã£ã‹ã‚ŠæŠ¼ã—ã¦ã—ã¾ã£ãŸãªã‚‰ã€ãã£ã¨ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¦ã­ã€‚
        <div class="reset-note">
          â€»ãƒªã‚»ãƒƒãƒˆã—ã¦ã‚‚ã€ã‚ãªãŸã®ã†ã‚“ã‚‚ã‚‰ã®èª‡ã‚Šã¾ã§ã¯æ¶ˆãˆã¾ã›ã‚“ã€‚
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" id="resetCancelButton">ã‚„ã£ã±ã‚Šã‚„ã‚ã‚‹</button>
        <button class="btn-close" id="resetConfirmButton">
          <span>ğŸ™</span><span>ã‚ã‚ŠãŒãŸããƒªã‚»ãƒƒãƒˆã™ã‚‹</span>
        </button>
      </div>
    </div>
  </div>

  <script>
    // --- å®šæ•°ãƒ»DOMå‚ç…§ ---
    const STAMP_MAX = 10;
    const STORAGE_KEY = "unmoraCardData_v1";

    const stampGrid = document.getElementById("stampGrid");
    const stampCountLabel = document.getElementById("stampCountLabel");
    const totalUnmoraLabel = document.getElementById("totalUnmoraLabel");
    const totalUnmoraLabelHistory = document.getElementById("totalUnmoraLabelHistory");
    const badgeCountLabel = document.getElementById("badgeCountLabel");
    const badgeCountLabelHistory = document.getElementById("badgeCountLabelHistory");
    const progressFill = document.getElementById("progressFill");
    const unmoraButton = document.getElementById("unmoraButton");
    const resetButton = document.getElementById("resetButton");
    const lifehackText = document.getElementById("lifehackText");
    const lastUnmoraLabel = document.getElementById("lastUnmoraLabel");
    const elapsedLabel = document.getElementById("elapsedLabel");
    const todayCountLabel = document.getElementById("todayCountLabel");
    const monthCountLabel = document.getElementById("monthCountLabel");
    const historyList = document.getElementById("historyList");

    const akaneModalBackdrop = document.getElementById("akaneModalBackdrop");
    const akaneMessage = document.getElementById("akaneMessage");
    const akaneCloseButton = document.getElementById("akaneCloseButton");

    const badgeModalBackdrop = document.getElementById("badgeModalBackdrop");
    const badgeCloseButton = document.getElementById("badgeCloseButton");

    const resetModalBackdrop = document.getElementById("resetModalBackdrop");
    const resetCancelButton = document.getElementById("resetCancelButton");
    const resetConfirmButton = document.getElementById("resetConfirmButton");

    const tabButtons = document.querySelectorAll(".tab-btn");
    const pages = document.querySelectorAll(".page");

    // --- ãƒ‡ãƒ¼ã‚¿æ§‹é€  ---
    let state = {
      stampCount: 0,
      totalUnmora: 0,
      badgeCount: 0,
      history: [], // { timestamp: number }
      lastUnmora: null, // number
    };

    const akaneMessages = [
      "ä»Šæ—¥ã®ã†ã‚“ã‚‚ã‚‰ã€å½¢ãŒè‰¯ã‹ã£ãŸã‚‰ãƒ©ãƒƒã‚­ãƒ¼ãƒ‡ãƒ¼ã€‚æ‚ªãã¦ã‚‚ãƒã‚¿ã«ãªã‚‹ã‹ã‚‰å¤§ä¸ˆå¤«ã€‚",
      "ãƒˆã‚¤ãƒ¬ã«å…¥ã‚‹å‰ã«ã‚¹ãƒãƒ›ã‚’ç½®ã„ã¦ã„ãã¨ã€ã†ã‚“ã‚‚ã‚‰ã«å…¨é›†ä¸­ã§ãã‚‹ã‚ˆã€‚ï¼ˆã§ãã‚‹ã¨ã¯è¨€ã£ã¦ãªã„ï¼‰",
      "æ°´ã‚’ä¸€å£é£²ã‚“ã§ã‹ã‚‰ã†ã‚“ã‚‚ã‚‰ã™ã‚‹ã¨ã€ãªã‚“ã¨ãªãå¥åº·ã‚ªã‚¿ã‚¯ã£ã½ãè¦‹ãˆã¾ã™ã€‚",
      "ã†ã‚“ã‚‚ã‚‰ã®éŸ³ãŒæ°—ã«ãªã‚‹æ—¥ã¯ã€é¼»æ­Œã‚’æ­Œã£ã¦ã”ã¾ã‹ãã†ã€‚ãƒªã‚ºãƒ æ„Ÿã‚‚é›ãˆã‚‰ã‚Œã‚‹ã‚ˆã€‚",
      "ãƒˆã‚¤ãƒ¬ãƒƒãƒˆãƒšãƒ¼ãƒ‘ãƒ¼ã‚’ä¸‰è§’ã«æŠ˜ã‚‹ã¨ã€ãªãœã‹ä»•äº‹ã‚’ã‚„ã‚Šåˆ‡ã£ãŸæ°—åˆ†ã«ãªã‚Œã¾ã™ã€‚",
      "ã†ã‚“ã‚‚ã‚‰ã®å‰å¾Œã§ã‚¹ãƒˆãƒ¬ãƒƒãƒã™ã‚‹ã¨ã€ã€ãªã‚“ã‹ã‚„ã£ã¦ã‚‹æ„Ÿã€ãŒ2å€ã«ãªã‚Šã¾ã™ã€‚",
      "ãƒˆã‚¤ãƒ¬ã«ãŠæ°—ã«å…¥ã‚Šã®é¦™ã‚Šã‚’ç½®ãã¨ã€ã†ã‚“ã‚‚ã‚‰ãŒã¡ã‚‡ã£ã¨ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã«ãªã‚Šã¾ã™ã€‚",
      "ã†ã‚“ã‚‚ã‚‰ã®æ™‚é–“ã‚’ã€è‡ªåˆ†ä¼šè­°ã€ã«ã™ã‚‹ã¨ã€å¦™ã«åæ¡ˆãŒæµ®ã‹ã¶â€¦ã‹ã‚‚ã—ã‚Œãªã„ã€‚",
      "ä¾¿åº§ã«åº§ã£ãŸã‚‰ã€ã¾ãšä»Šæ—¥ã®è‡ªåˆ†ã‚’è¤’ã‚ã¦ã¿ã‚ˆã†ã€‚ã†ã‚“ã‚‚ã‚‰ã‚‚ãã£ã¨ã‚¹ãƒ ãƒ¼ã‚ºã«ã€‚",
      "ã†ã‚“ã‚‚ã‚‰ã®ã‚ã¨ã€æ‰‹ã‚’æ´—ã†ã¨ãã«ã€ä»Šæ—¥ã‚‚ãˆã‚‰ã„ã€ã£ã¦å¿ƒã®ä¸­ã§è¨€ã£ã¦ã‚ã’ã¦ã­ã€‚"
    ];

    const akanePraiseMessages = [
      "ãƒŠã‚¤ã‚¹ã†ã‚“ã‚‚ã‚‰ï¼ãã®èª¿å­ã§è…¸ã¨ã®ä¿¡é ¼é–¢ä¿‚ã‚’æ·±ã‚ã¦ã„ã“ã†ã€‚",
      "ä»Šæ—¥ã®ã†ã‚“ã‚‚ã‚‰ã€ãã£ã¨æœªæ¥ã®ã‚ãªãŸã‚’æ•‘ã£ã¦ã¾ã™ã€‚ãŸã¶ã‚“ã€‚",
      "ã†ã‚“ã‚‚ã‚‰ã‚’è¨˜éŒ²ã™ã‚‹äººã¯ã€ã™ã§ã«å¥åº·ã‚ªã‚¿ã‚¯ã®å…¥ã‚Šå£ã«ç«‹ã£ã¦ã¾ã™ã€‚ã‚ˆã†ã“ãã€‚",
      "å‡ºã™ã‚‚ã®å‡ºã—ãŸã‚‰ã€ã‚ã¨ã¯è»½ããªã‚‹ã ã‘ã€‚å¿ƒã‚‚ã€ã­ã€‚",
      "ã†ã‚“ã‚‚ã‚‰ã‚’ç¬‘ã†è€…ã¯ã€ã†ã‚“ã‚‚ã‚‰ã«æ³£ãã€‚ä»Šã®ã‚ãªãŸã¯å‹ã¡çµ„ã§ã™ã€‚",
      "ä»Šæ—¥ã®ã†ã‚“ã‚‚ã‚‰ã€10å¹´å¾Œã®ã‚ãªãŸã‹ã‚‰æ„Ÿè¬ã•ã‚Œã¦ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ï¼ˆã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ï¼‰",
      "ã¡ã‚ƒã‚“ã¨å‡ºã›ãŸæ—¥ã¯ã€ãã‚Œã ã‘ã§100ç‚¹æº€ç‚¹ã€‚ãŠã‚ã§ã¨ã†ã€‚",
      "ã†ã‚“ã‚‚ã‚‰ã‚’å¤§äº‹ã«ã™ã‚‹äººã¯ã€è‡ªåˆ†ã‚‚å¤§äº‹ã«ã§ãã‚‹äººã ã‚ˆã€‚ãˆã‚‰ã„ã€‚"
    ];

    const badgeMessages = [
      "10å›é”æˆï¼è…¸ã¨ã®çµ†ãŒ1ãƒ¬ãƒ™ãƒ«ä¸ŠãŒã‚Šã¾ã—ãŸã€‚",
      "ã‚¹ãƒšã‚·ãƒ£ãƒ«ã†ã‚“ã‚‚ã‚‰ãƒãƒƒã‚¸æˆä¸ï¼ä»Šæ—¥ã‹ã‚‰ã‚ãªãŸã¯ã€ã†ã‚“ã‚‚ã‚‰ãƒã‚¹ã‚¿ãƒ¼ã€ã§ã™ã€‚",
      "ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆãŠã‚ã§ã¨ã†ï¼ãƒˆã‚¤ãƒ¬ã®ç¥æ§˜ã‚‚ãƒ‹ãƒƒã‚³ãƒªã—ã¦ã‚‹ã¯ãšã€‚",
      "ã“ã“ã¾ã§ç¶šã‘ãŸã‚ãªãŸã«ã€èŒœã‹ã‚‰æœ€å¤§ç´šã®æ‹æ‰‹ã‚’é€ã‚Šã¾ã™ã€‚ãƒ‘ãƒãƒ‘ãƒãƒ‘ãƒï¼"
    ];

    const lifehacks = [
        "ãƒˆã‚¤ãƒ¬ã«å…¥ã‚‹å‰ã«ã€æ·±å‘¼å¸ã‚’3å›ã™ã‚‹ã¨ã€ãªãœã‹ã¡ã‚‡ã£ã¨ãƒ—ãƒ­ã£ã½ã„æ°—åˆ†ã«ãªã‚Œã‚‹ã‚ˆã€‚",
        "ãƒˆã‚¤ãƒ¬ã®ãƒ‰ã‚¢ã‚’é™ã‹ã«é–‰ã‚ã‚‹ã¨ã€ãªãœã‹ã†ã‚“ã‚‚ã‚‰ã‚‚ä¸Šå“ã«ãªã‚‹â€¦æ°—ãŒã™ã‚‹ã ã‘ã ã‚ˆã€‚",
        "ã†ã‚“ã‚‚ã‚‰å‰ã«ã€ä»Šæ—¥ã‚‚ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ã€ã£ã¦å¿ƒã®ä¸­ã§è¨€ã†ã¨ã€ã¡ã‚‡ã£ã¨ä»²è‰¯ããªã‚Œã‚‹ã‚ˆã€‚",
        "ãƒˆã‚¤ãƒ¬ã®é›»æ°—ã‚’ã¤ã‘ã‚‹ã¨ãã€è»½ãã‚¹ãƒˆãƒ¬ãƒƒãƒã™ã‚‹ã¨ã€ãªã‚“ã‹å¥åº·ã£ã½ã„é›°å›²æ°—ãŒå‡ºã‚‹ã‚ˆã€‚",
        "ãƒˆã‚¤ãƒ¬ã®åºŠã®ã‚¿ã‚¤ãƒ«ã‚’æ•°ãˆã¦ã„ã‚‹ã¨ã€æ°—ã¥ã„ãŸã‚‰ã†ã‚“ã‚‚ã‚‰ãŒçµ‚ã‚ã£ã¦ã‚‹ã“ã¨ãŒã‚ã‚‹ã‚ˆã€‚",
        "ã†ã‚“ã‚‚ã‚‰ã®ã‚ã¨ã€é¡ã‚’è¦‹ã¦ãƒ‹ãƒ¤ãƒƒã¨ã™ã‚‹ã¨ã€1æ—¥ã®ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãŒ0.5ä¸ŠãŒã‚‹ã‚‰ã—ã„ã‚ˆã€‚ï¼ˆèŒœèª¿ã¹ï¼‰",
        "ãƒˆã‚¤ãƒ¬ã«ãŠæ°—ã«å…¥ã‚Šã®é¦™ã‚Šã‚’1ã¤ç½®ã„ã¦ãŠãã¨ã€ã†ã‚“ã‚‚ã‚‰ãŒã¡ã‚‡ã£ã¨ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã«ãªã‚‹ã‚ˆã€‚",
        "ãƒˆã‚¤ãƒ¬ã‹ã‚‰å‡ºã‚‹ã¨ãã«ã€ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆã€ã£ã¦å¿ƒã®ä¸­ã§è¨€ã†ã¨ã€ã¡ã‚‡ã£ã¨å¼·ããªã£ãŸæ°—ãŒã™ã‚‹ã‚ˆã€‚",
        "ã†ã‚“ã‚‚ã‚‰ã®å‰ã«è¶³é¦–ã‚’ãã‚‹ãã‚‹å›ã™ã¨ã€ãªã‚“ã‹é€šã£ã½ã„æ„Ÿã˜ãŒã™ã‚‹ã‚ˆã­ã€‚",
        "ãƒˆã‚¤ãƒ¬ã®æ™‚é–“ã‚’ã€è‡ªåˆ†ä¼šè­°ã‚¿ã‚¤ãƒ ã€ã£ã¦å‘¼ã¶ã¨ã€æ€¥ã«å¤§äº‹ãªæ™‚é–“ã£ã½ããªã‚‹ã‚ˆã€‚",
      "ã†ã‚“ã‚‚ã‚‰ã®ã“ã¨ã‚’ã€Œè…¸ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã€ã¨å‘¼ã¶ã¨ã€ãªã‚“ã ã‹ä»•äº‹ã—ã¦ã‚‹æ„ŸãŒå‡ºã‚‹ã‚ˆã€‚"
    ];

    // --- ãƒ­ãƒ¼ãƒ‰ãƒ»ä¿å­˜ ---
    function loadState() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return;
        const data = JSON.parse(raw);
        if (typeof data.stampCount === "number") state.stampCount = data.stampCount;
        if (typeof data.totalUnmora === "number") state.totalUnmora = data.totalUnmora;
        if (typeof data.badgeCount === "number") state.badgeCount = data.badgeCount;
        if (Array.isArray(data.history)) state.history = data.history;
        if (typeof data.lastUnmora === "number") state.lastUnmora = data.lastUnmora;
      } catch (e) {
        console.warn("Failed to load state", e);
      }
    }

    function saveState() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
      } catch (e) {
        console.warn("Failed to save state", e);
      }
    }

    // --- UIæ›´æ–° ---
    function renderStampGrid() {
      stampGrid.innerHTML = "";
      for (let i = 0; i < STAMP_MAX; i++) {
        const slot = document.createElement("div");
        slot.className = "stamp-slot";
        if (i < state.stampCount) {
          slot.classList.add("filled");
          slot.textContent = "ğŸ’©";
        } else {
          slot.textContent = (i + 1).toString();
        }
        stampGrid.appendChild(slot);
      }
    }

    function renderCounts() {
      stampCountLabel.textContent = state.stampCount;
      totalUnmoraLabel.textContent = state.totalUnmora;
      totalUnmoraLabelHistory.textContent = state.totalUnmora;
      badgeCountLabel.textContent = "Ã—" + state.badgeCount;
      badgeCountLabelHistory.textContent = state.badgeCount;
      const ratio = Math.min(state.stampCount / STAMP_MAX, 1);
      progressFill.style.width = (ratio * 100).toFixed(0) + "%";
    }

    function formatDateTime(ts) {
      const d = new Date(ts);
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, "0");
      const day = String(d.getDate()).padStart(2, "0");
      const hh = String(d.getHours()).padStart(2, "0");
      const mm = String(d.getMinutes()).padStart(2, "0");
      const ss = String(d.getSeconds()).padStart(2, "0");
      return `${y}/${m}/${day} ${hh}:${mm}:${ss}`;
    }

    function renderLastUnmora() {
      if (!state.lastUnmora) {
        lastUnmoraLabel.textContent = "ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“";
        elapsedLabel.textContent = "å‰å›ã®ã†ã‚“ã‚‚ã‚‰ã‹ã‚‰ã®çµŒéæ™‚é–“ï¼šâ€•";
        todayCountLabel.textContent = "0";
        monthCountLabel.textContent = "0";
        return;
      }
      lastUnmoraLabel.textContent = formatDateTime(state.lastUnmora);

      // ä»Šæ—¥ãƒ»ä»Šæœˆã®å›æ•°
      const now = new Date();
      let todayCount = 0;
      let monthCount = 0;
      state.history.forEach((h) => {
        const d = new Date(h.timestamp);
        if (
          d.getFullYear() === now.getFullYear() &&
          d.getMonth() === now.getMonth()
        ) {
          monthCount++;
          if (d.getDate() === now.getDate()) {
            todayCount++;
          }
        }
      });
      todayCountLabel.textContent = todayCount;
      monthCountLabel.textContent = monthCount;
    }

    function updateElapsedTime() {
      if (!state.lastUnmora) return;
      const now = Date.now();
      const diffMs = now - state.lastUnmora;
      if (diffMs < 0) return;
      const totalSec = Math.floor(diffMs / 1000);
      const hours = Math.floor(totalSec / 3600);
      const minutes = Math.floor((totalSec % 3600) / 60);
      const seconds = totalSec % 60;
      let text = "å‰å›ã®ã†ã‚“ã‚‚ã‚‰ã‹ã‚‰ã®çµŒéæ™‚é–“ï¼š";
      if (hours > 0) text += `${hours}æ™‚é–“`;
      if (minutes > 0 || hours > 0) text += `${minutes}åˆ†`;
      text += `${seconds}ç§’`;
      elapsedLabel.innerHTML = text;
    }

    function renderHistory() {
      historyList.innerHTML = "";
      if (!state.history.length) {
        const empty = document.createElement("div");
        empty.className = "history-empty";
        empty.textContent = "ã¾ã ã†ã‚“ã‚‚ã‚‰ã®è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“ã€‚åˆã†ã‚“ã‚‚ã‚‰ã€ãŠå¾…ã¡ã—ã¦ã¾ã™ã€‚";
        historyList.appendChild(empty);
        return;
      }
      const sorted = [...state.history].sort((a, b) => b.timestamp - a.timestamp);
      sorted.forEach((h, index) => {
        const item = document.createElement("div");
        item.className = "history-item";
        const left = document.createElement("div");
        left.innerHTML = `<span class="label">ã†ã‚“ã‚‚ã‚‰ #${sorted.length - index}</span>`;
        const right = document.createElement("div");
        right.textContent = formatDateTime(h.timestamp);
        item.appendChild(left);
        item.appendChild(right);
        historyList.appendChild(item);
      });
    }

    function renderLifehack(randomize = false) {
      if (!randomize) return;
      const idx = Math.floor(Math.random() * lifehacks.length);
      lifehackText.textContent = lifehacks[idx];
    }

    // --- ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡ ---
    function openAkaneModal(message) {
      akaneMessage.innerHTML = message.replace(/\n/g, "<br />");
      akaneModalBackdrop.classList.add("active");
    }

    function closeAkaneModal() {
      akaneModalBackdrop.classList.remove("active");
    }

    function openBadgeModal() {
      const msg = badgeMessages[Math.floor(Math.random() * badgeMessages.length)];
      const body = `
        ${msg}<br /><br />
        <div class="badge-celebration">
          <strong>âœ¨ èŒœã‚ˆã‚Šï¼š</strong> ã“ã“ã¾ã§ç¶šã‘ãŸã‚ãªãŸã«ã€è…¸ã‹ã‚‰ã®ã‚¹ã‚¿ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚ªãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã€‚
        </div>
      `;
      document.getElementById("badgeMessage").innerHTML = body;
      badgeModalBackdrop.classList.add("active");
    }

    function closeBadgeModal() {
      badgeModalBackdrop.classList.remove("active");
    }

    function openResetModal() {
      resetModalBackdrop.classList.add("active");
    }

    function closeResetModal() {
      resetModalBackdrop.classList.remove("active");
    }

    // --- ã‚¤ãƒ™ãƒ³ãƒˆ ---
    unmoraButton.addEventListener("click", () => {
      if (state.stampCount >= STAMP_MAX) {
        openAkaneModal(
          "ã‚¹ã‚¿ãƒ³ãƒ—ã‚«ãƒ¼ãƒ‰ã¯æº€ã‚¿ãƒ³ã§ã™ï¼<br />æ–°ã—ã„ã‚«ãƒ¼ãƒ‰ã‚’å§‹ã‚ã‚‹ã«ã¯ã€ãƒªã‚»ãƒƒãƒˆã—ã¦ã­ã€‚<br />ï¼ˆã†ã‚“ã‚‚ã‚‰è‡ªä½“ã¯ã„ã¤ã§ã‚‚æ­“è¿ã ã‚ˆï¼‰"
        );
        return;
      }

      const now = Date.now();
      state.stampCount++;
      state.totalUnmora++;
      state.lastUnmora = now;
      state.history.push({ timestamp: now });

      // èŒœã®ãŠè¨€è‘‰
      const msg =
        akanePraiseMessages[
          Math.floor(Math.random() * akanePraiseMessages.length)
        ];
      openAkaneModal(msg);

      // ãƒ©ã‚¤ãƒ•ãƒãƒƒã‚¯æ›´æ–°
      renderLifehack(true);

      // 10å€‹é”æˆãƒã‚§ãƒƒã‚¯
      let reachedBadge = false;
      if (state.stampCount >= STAMP_MAX) {
        state.badgeCount++;
        reachedBadge = true;
      }

      saveState();
      renderStampGrid();
      renderCounts();
      renderLastUnmora();
      renderHistory();
      updateElapsedTime();

      if (reachedBadge) {
        // å°‘ã—é…ã‚‰ã›ã¦ãŠç¥ã„ãƒ¢ãƒ¼ãƒ€ãƒ«
        setTimeout(openBadgeModal, 400);
      }
    });

    akaneCloseButton.addEventListener("click", closeAkaneModal);
    akaneModalBackdrop.addEventListener("click", (e) => {
      if (e.target === akaneModalBackdrop) closeAkaneModal();
    });

    badgeCloseButton.addEventListener("click", closeBadgeModal);
    badgeModalBackdrop.addEventListener("click", (e) => {
      if (e.target === badgeModalBackdrop) closeBadgeModal();
    });

    resetButton.addEventListener("click", openResetModal);
    resetCancelButton.addEventListener("click", closeResetModal);
    resetModalBackdrop.addEventListener("click", (e) => {
      if (e.target === resetModalBackdrop) closeResetModal();
    });

    resetConfirmButton.addEventListener("click", () => {
      state = {
        stampCount: 0,
        totalUnmora: 0,
        badgeCount: 0,
        history: [],
        lastUnmora: null
      };
      saveState();
      renderStampGrid();
      renderCounts();
      renderLastUnmora();
      renderHistory();
      updateElapsedTime();
      closeResetModal();
      openAkaneModal("ã™ã¹ã¦ãƒªã‚»ãƒƒãƒˆå®Œäº†ï¼<br />ã“ã“ã‹ã‚‰ã¾ãŸã€æ–°ã—ã„ã†ã‚“ã‚‚ã‚‰ç‰©èªã‚’å§‹ã‚ã‚ˆã†ã€‚");
      renderLifehack(true);
    });

    tabButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        const tab = btn.dataset.tab;
        tabButtons.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");
        pages.forEach((p) => {
          p.classList.toggle("active", p.id === "page-" + tab);
        });
      });
    });

    // --- åˆæœŸåŒ– ---
    function init() {
      loadState();
      renderStampGrid();
      renderCounts();
      renderLastUnmora();
      renderHistory();
      renderLifehack(true);
      updateElapsedTime();
      setInterval(updateElapsedTime, 1000);
    }

    init();
  </script>
</body>
</html>